var lat,longi,loca,pressetext,stamp,city=1,style,dbReadData,dbResult,kolumneID,specID,newsID,kolID,specialID,ticketID,read,newsName,pageName,infowindow,sqlsupport=!!window.openDatabase;if(sqlsupport){var db=window.openDatabase("merkzettel","1.0","merkzettel",2E5);db.transaction(dropOldDB);db.transaction(populateDB)}$.ajaxSetup({cache:!1});$(document).on("pageshow",function(){sqlsupport&&checkForUpdates()});
$(function(){document.addEventListener("deviceready",deviceReady,!1);var a=$.mobile.changePage,b=!1;$.mobile.changePage=function(c,f){blockUI();b&&clearTimeout(b);b=setTimeout(function(){a(c,f);unblockUI()},100)}});$("#cityDD").live("click",function(){city=1;$.mobile.changePage("index.html",{allowSamePageTransition:!0})});$("#cityLE").live("click",function(){city=2;$.mobile.changePage("index.html",{allowSamePageTransition:!0})});
$("#todayBtn").live("click",function(){var a=new Date,a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),a=Date.parse(a);stamp=a/1E3;$.mobile.changePage("index.html",{allowSamePageTransition:!0})});$("#todayIcn").live("click",function(){var a=new Date,a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),a=Date.parse(a);stamp=a/1E3;$.mobile.changePage("index.html",{allowSamePageTransition:!0})});
$(".gmap_btn").live("click",function(){lat=$(this).parent().parent().parent().children(".lat").text();longi=$(this).parent().parent().parent().children(".long").text();loca=$(this).parent().parent().parent().children(".location").text();$.mobile.changePage("map.html")});$(".presse_btn").live("click",function(){pressetext=$(this).parent().parent().parent().parent().children(".information").html();$.mobile.changePage("presse.html")});
$(".one_date").live("click",function(){$(this).children(".detail").is(":visible")?($(this).children().children(".moreContent").show(),$(this).children(".lessContent").hide(),$(this).children(".detail").hide()):($(".detail").hide(),$(this).children(".moreContent").hide(),$(this).children(".lessContent").show(),$(this).children(".detail").show())});
$("#start").live("pagecreate",function(){$("#start").bind("swipeleft",function(){var a=$(".dateOverlay").text().split(".");b=Date.parse(a[1]+"/"+a[0]+"/"+a[2]);b/=1E3;stamp=b+=86400;$.mobile.changePage("index.html",{allowSamePageTransition:!0})});$("#start").bind("swiperight",function(){var a=$(".dateOverlay").text().split(".");b=Date.parse(a[1]+"/"+a[0]+"/"+a[2]);b/=1E3;stamp=b-=86400;$.mobile.changePage("index.html",{allowSamePageTransition:!0})});var a=new Date,a=new Date(a.getFullYear(),a.getMonth(),
a.getDate()),b=Date.parse(a);stamp=b/=1E3});$("#start").live("pageshow",function(){setCity();parseHtml(stamp,city)});
$("#cal").live("pageinit",function(){$("#calendar").fullCalendar({buttonText:{prev:"&nbsp;&laquo;&nbsp;",next:"&nbsp;&raquo;&nbsp;"},height:get_calendar_height(),header:{left:"prev",center:"title",right:"next"},monthNames:"Januar Februar M\u00e4rz April Mai Juni Juli August September Oktober November Dezember".split(" "),monthNamesShort:"Jan Feb M\u00e4r Apr Mai Jun Jul Aug Sep Okt Nov Dez".split(" "),dayNamesShort:"So Mo Di Mi Do Fr Sa".split(" "),dayClick:function(a){timestamp=Date.parse(a);stamp=
timestamp/1E3;$.mobile.changePage("index.html")},columnFormat:{month:"ddd",week:"ddd d/M",day:"dddd d/M"}})});$("#cal").live("pageshow",function(){$("#calendar").fullCalendar("render")});
$("#news").live("pageshow",function(){$(".loader").show();var a="";$("#news_wrap").empty();$.get("http://www.banq.de/api/api3.php?action=getNews&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(b){$.each(b.allNews,function(c,b){a+='<div data-role="collapsible" class="news_field">';a+="<h3>"+b.news.title+"</h3>";a+="<p><small>"+b.news.date+"</small><br/><br/><strong>"+b.news.title+"</strong><br/><br/>"+b.news.content.replace(/\n/g,"<br />")+"<br/><br/>";a+="</div>"});$("#news_wrap").append(a);
$("#news_wrap").collapsibleset("refresh");$(".loader").hide()});pageName="news";sqlsupport&&db.transaction(setRead,errorCB)});
$("#spezial").live("pageshow",function(){$(".loader").show();var a="";$("#spezial_wrap").empty();$.get("http://www.banq.de/api/api3.php?action=getListOfSpecials&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(b){$.each(b.allSpecials,function(c,b){a+="<li>";a+='<a onclick="showSpecial('+b.special.id+')" href="#">'+b.special.title+"</a>";a+="</li>"});$("#spezial_wrap").append(a);$("#spezial_wrap").listview("refresh");$(".loader").hide()});pageName="special";sqlsupport&&db.transaction(setRead,
errorCB)});
$("#kolumne").live("pageshow",function(){$(".loader").show();var a="";$("#kolumne_wrap").empty();$.get("http://www.banq.de/api/api3.php?action=getListOfColumns&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(b){$.each(b.allColumns,function(c,b){a+="<li>";a+='<a onclick="showKolumne('+b.column.id+')" href="#">'+b.column.title+"</a>";a+="</li>"});$("#kolumne_wrap").append(a);$("#kolumne_wrap").listview("refresh");$(".loader").hide()});pageName="kolumne";sqlsupport&&db.transaction(setRead,errorCB)});
$("#kolumne_detail").live("pageshow",function(){$(".loader").show();$.get("http://www.banq.de/api/api3.php?action=getColumnById&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json&columnId="+kolumneID,function(a){var b=a.column.text.replace(/\n/g,"<br />");$("#kolumneTitle").append(a.column.title);$("#kolumnetext").append(b);$(".loader").hide()})});
$("#spezial_detail").live("pageshow",function(){$(".loader").show();$.get("http://www.banq.de/api/api3.php?action=getSpecialById&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json&specialId="+specID,function(a){var b=a.special.text.replace(/\n/g,"<br />");$("#spezialTitle").append(a.special.title);$("#spezialtext").append(b);$(".loader").hide()})});
$("#tickets").live("pageshow",function(){$(".loader").show();var a="";$("#ticket_wrap").empty();$.get("http://www.banq.de/api/api3.php?action=getRaffles&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(b){$.each(b.allRaffles,function(c,b){a+='<div data-role="collapsible" class="news_field">';a+="<h3>"+b.raffle.title+"</h3>";a+="<p><small>"+b.raffle.date+"</small><br/><br/><strong>"+b.raffle.title+"</strong><br/><br/>"+b.raffle.content.replace(/\n/g,"<br />").replace(/<img[\s\S]*?>/g,
"&nbsp;")+"<br/><br/>";a+="-------------------<br/><br/>";a+='Auf <a style="color:#BC0000;" href="'+b.raffle.linkToNews+'">banq.de</a> teilnehmen</p>';a+="</div>"});$("#ticket_wrap").append(a);$("#ticket_wrap").collapsibleset("refresh");$(".loader").hide()});pageName="ticket";sqlsupport&&db.transaction(setRead,errorCB)});
$("#styles").live("pageshow",function(){$(".loader").show();var a="";$("#style_wrap").empty();$.get("http://www.banq.de/api/api3.php?action=getListOfStyles&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json&cityId="+city,function(b){$.each(b.allStyles,function(c,b){a+="<li>";a+='<a onclick="showStyle('+b.style.id+')" href="#">'+b.style.styleName+"</a>";a+="</li>"});$("#style_wrap").append(a);$("#style_wrap").listview("refresh");$(".loader").hide()});setCity()});
$("#presse").live("pageshow",function(){$("#pressetext").empty();$("#pressetext").append(pressetext.replace(/\n/g,"<br />"))});$(".live-map").live("pageshow",function(){height=$("html").height();width=$("html").width();$("#live_map_canvas").css("height",height-112);$("#live_map_canvas").css("width",width);loadLiveMap();setCity()});$(".page-map").live("pageshow",function(){height=$("html").height();$("#map_canvas").css("height",height-112);loadMap(lat,longi,loca)});
$("#style_detail").live("pageshow",function(){$(".loader").show();var a="",b,c;$.get("http://www.banq.de/api/api3.php?action=getEventBanner&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(a){b=a.banner.imageUrl;c=a.banner.link});$.get("http://www.banq.de/api/api3.php?action=getEventsByStyle&cityId="+city+"&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json&styleId="+style,function(f){$("#date_style_wrap").empty();if(f){var g;$.each(f.event,function(d,e){var k="",f="",h=
"",l="",m="",n="";e.eventStyles&&$.each(e.eventStyles,function(a,c){j=++a;k=null!=e.eventStyles[j]||void 0!=e.eventStyles[j]?k+(c.styleName+" | "):k+c.styleName});e.eventDate.lineup&&(f=e.eventDate.lineup.replace(/\n/g,"<br />"));e.eventDate.name&&(h=e.eventDate.name.replace(/\n/g,"<br />"));e.eventLocation.name&&(l=e.eventLocation.name.replace(/\n/g,"<br />"));e.eventDate.startTime&&(m=e.eventDate.startTime.replace(/\n/g,"<br />").substring(0,5));e.eventDate.price&&(n=e.eventDate.price.replace(/\n/g,
"<br />"));3==d&&(a+='<div class="banner">',a+='<a href="'+c+'"><img src="'+b+'" /></a>',a+="</div>");0==d?(g=e.eventDate.date,a+='<div data-role="navbar" class="navbarTop" data-theme="d"><span>'+e.eventDate.date+"</span></div>"):g!=e.eventDate.date&&(g=e.eventDate.date,a+='<div data-role="navbar" class="navbarTop" data-theme="d"><span>'+e.eventDate.date+"</span></div>");a+='<div style="clear:both;"></div>';a+='<div class="one_date">';!0==e.eventDate.tipp&&(a+='<div class="tipp"><img src="img/tipp.png" /></div>');
a+='<div class="flyer">';a=null!=e.eventFlyer.front?a+('<img src="'+e.eventFlyer.front+'" width="100" />'):a+'<img src="img/platzhalter.gif" width="100" />';a+="</div>";a+='<div class="content_meta">';a+='<div class="what">'+h+"</div>";a+='<div class="where"><a href="#" class="gmap_btn"><img width="12" src="./img/icons/07-map-marker-dark.png" alt="Map" /> <span class="locationName">'+l+"</span></a></div>";a+='<div class="genre">'+k+"</div>";a+='<div class="moreContent"><img src="img/arrow.gif" /></div>';
a+="</div>";a+='<div style="clear:both; height:0px;">&nbsp;</div>';a+='<div style="display:none;" class="detail">';a+='<div class="what_detail"><strong>Event:</strong><br/>'+h+"</div><br/>";k&&(a+='<div class="genre_detail"><strong>Genre:</strong><br/>'+k+"</div><br/>");m&&(a+='<div class="startTime"><strong>Uhrzeit:</strong><br/>'+m+" Uhr</div><br/>");n&&(a+='<div class="price"><strong>Preis:</strong><br/>'+n+"</div><br/>");f&&(a+='<div class="lineup"><strong>Lineup:</strong><br/>'+f+"</div><br/>");
a+='<ul class="more">';e.eventDate.informations&&(pressetext=e.eventDate.informations,a+='<li><a class="presse_btn"><img src="img/icnPresse.png" /> <span>Details</span></a></li>');e.eventDate.mediaLink&&(a+='<li><a rel="external" href="'+e.eventDate.mediaLink+'"><img src="img/icnMedia.png" /> <span>Media</span></a></li>');e.eventDate.onlineTicketSale&&(a+='<li><a href="'+e.eventDate.onlineTicketSale+'"><img src="img/icnTicket.png" /> <span>Tickets</span></a></li>');a+='<div class="clear">&nbsp;</div></ul>';
a+="</div>";a+='<div style="display:none" class="lat">'+e.eventLocation.latitude+"</div>";a+='<div style="display:none" class="long">'+e.eventLocation.longitude+"</div>";a+='<div style="display:none" class="information">'+e.eventDate.informations+"</div>";a+='<div style="display:none" class="eventDate">'+e.eventDate.date+"</div>";a+='<div style="display:none" class="location">'+l+"</div>";a+="</div>"})}else a+="Keine Veranstaltungen gefunden.";$("#date_style_wrap").append(a).trigger("create");$(".loader").hide()})});
$("#bar_list").live("pageshow",function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){setBars("&latitude="+a.coords.latitude,"&longitude="+a.coords.longitude)},function(){setBars("","")}):setBars("","");var a="";$.get("http://www.banq.de/api/api3.php?action=getListOfEatFoodCategories&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(b){$("#popupBar").empty();b&&$.each(b.allCategories,function(c,b){a+='<div  data-role="fieldcontain">';a+='<fieldset data-role="controlgroup" id="barOptionList">';
a+='<input type="checkbox" name="'+b.category.name+'" value="'+b.category.id+'" class="custom" />';a+='<label for="'+b.category.name+'">'+b.category.name+"</label>";a+="</fieldset>";a+="</div>"});$("#popupBar").append(a).trigger("create")})});
function setBars(a,b){$(".loader").show();$("#bar_wrap").empty();var c="",f,g;$.get("http://www.banq.de/api/api3.php?action=getEatFoodBanner&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(a){f=a.banner.imageUrl;g=a.banner.link});$.get("http://www.banq.de/api/api3.php?apiKey=acd8b192c5aad5f134d1e4d5b70a299a&action=getEatFood&outputFormat=json"+a+b,function(a){a?$.each(a.locations,function(a,b){var d="",h="";b.categories&&$.each(b.categories,function(a,c){j=++a;d=null!=b.categories[j]||
void 0!=b.categories[j]?d+(c.category+", "):d+c.category});b.parameters&&$.each(b.parameters,function(a,b){h+="<div><strong>"+b.parameter+":</strong> "+b.parameterValue+"</div>"});3==a&&(c+='<div class="banner">',c+='<a href="'+g+'"><img src="'+f+'" /></a>',c+="</div>");c+='<div class="one_date">';c+='<div class="content_meta_bars">';c+='<div><a href="#" class="gmap_btn barname"><img width="12" src="./img/icons/07-map-marker-dark.png" alt="Map" /> <span class="locationName">'+b.location.name+"</span></a></div>";
c+='<div class="bargenre">'+d+"</div>";c+="<strong>Adresse:</strong><br/>";c+='<div class="street">'+b.location.street+"</div>";c+='<div class="postal">'+b.location.zip+", "+b.location.city+"<br/><br/></div>";b.location.distance&&(c+='<div class="distance"><strong>Entfernung: </strong>'+b.location.distance+"</div>");null!=h&&""!=h&&(c+='<div class="moreContent"><img src="img/arrow.gif" /></div>');c+="</div>";null!=h&&""!=h&&(c+='<div style="display:none;" class="detail">',c+=h,c+="</div>");c+='<div style="display:none" class="lat">'+
b.location.latitude+"</div>";c+='<div style="display:none" class="long">'+b.location.longitude+"</div>";c+='<div style="display:none" class="location">'+b.location.name+"</div>";c+="</div>"}):c+="Keine Locations gefunden.";$("#bar_wrap").append(c).trigger("create");$(".loader").hide()})}function showSpecial(a){specID=a;$.mobile.changePage("spezial_detail.html",{role:"dialog"})}function showStyle(a){style=a;$.mobile.changePage("style_detail.html")}
function showKolumne(a){kolumneID=a;$.mobile.changePage("kolumne_detail.html",{role:"dialog"})}
function parseHtml(a,b){$(".loader").show();var c=new Date;c.setTime(1E3*a);var f=c.getFullYear(),g="00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31".split(" ")[c.getDate()]+"."+"01 02 03 04 05 06 07 08 09 10 11 12".split(" ")[c.getMonth()]+"."+f;c.getMonth();c.getDate();var d="",e,k;$.get("http://www.banq.de/api/api3.php?action=getEventBanner&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(a){e=a.banner.imageUrl;k=a.banner.link});
$.get("http://www.banq.de/api/api3.php?action=getEvents&cityId="+b+"&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json&timestamp="+a,function(a){$("#date_wrap").empty();$("#date_change").empty();a?$.each(a.event,function(a,b){var c="",f="",g="",p="",q="",r="";b.eventStyles&&$.each(b.eventStyles,function(a,d){j=++a;c=null!=b.eventStyles[j]||void 0!=b.eventStyles[j]?c+(d.styleName+" | "):c+d.styleName});b.eventDate.lineup&&(f=b.eventDate.lineup.replace(/\n/g,"<br />"));b.eventDate.name&&(g=
b.eventDate.name.replace(/\n/g,"<br />"));b.eventLocation.name&&(p=b.eventLocation.name.replace(/\n/g,"<br />"));b.eventDate.startTime&&(q=b.eventDate.startTime.replace(/\n/g,"<br />").substring(0,5));b.eventDate.price&&(r=b.eventDate.price.replace(/\n/g,"<br />"));3==a&&(d+='<div class="banner">',d+='<a href="'+k+'"><img src="'+e+'" /></a>',d+="</div>");d+='<div class="one_date">';!0==b.eventDate.tipp&&(d+='<div class="tipp"><img src="img/tipp.png" /></div>');d+='<div class="flyer">';d=null!=b.eventFlyer.front?
d+('<img src="'+b.eventFlyer.front+'" width="100" />'):d+'<img src="img/platzhalter.gif" width="100" />';d+="</div>";d+='<div class="content_meta">';d+='<div class="what">'+g+"</div>";d+='<div class="where"><a href="#" class="gmap_btn"><img width="12" src="./img/icons/07-map-marker-dark.png" alt="Map" /> <span class="locationName">'+p+"</span></a></div>";d+='<div class="genre">'+c+"</div>";d+='<div class="moreContent"><img src="img/arrow.gif" /></div>';d+="</div>";d+='<div style="clear:both; height:0px;">&nbsp;</div>';
d+='<div style="display:none;" class="detail">';d+='<div class="what_detail"><strong>Event:</strong><br/>'+g+"</div><br/>";c&&(d+='<div class="genre_detail"><strong>Genre:</strong><br/>'+c+"</div><br/>");q&&(d+='<div class="startTime"><strong>Uhrzeit:</strong><br/>'+q+" Uhr</div><br/>");r&&(d+='<div class="price"><strong>Preis:</strong><br/>'+r+"</div><br/>");f&&(d+='<div class="lineup"><strong>Lineup:</strong><br/>'+f+"</div><br/>");d+='<ul class="more">';b.eventDate.informations&&(pressetext=b.eventDate.informations,
d+='<li><a class="presse_btn"><img src="img/icnPresse.png" /> <span>Details</span></a></li>');b.eventDate.mediaLink&&(d+='<li><a target="_blank" rel="external" href="'+b.eventDate.mediaLink+'"><img src="img/icnMedia.png" /> <span>Media</span></a></li>');b.eventDate.onlineTicketSale&&(d+='<li><a href="'+b.eventDate.onlineTicketSale+'"><img src="img/icnTicket.png" /> <span>Tickets</span></a></li>');d+='<div class="clear">&nbsp;</div></ul>';d+="</div>";d+='<div style="display:none" class="lat">'+b.eventLocation.latitude+
"</div>";d+='<div style="display:none" class="long">'+b.eventLocation.longitude+"</div>";d+='<div style="display:none" class="information">'+b.eventDate.informations+"</div>";d+='<div style="display:none" class="eventDate">'+b.eventDate.date+"</div>";d+='<div style="display:none" class="location">'+p+"</div>";d+="</div>"}):d+="Heute leider keine Veranstaltungen.";$("#date_wrap").append(d).trigger("create");$("#date_change").append('<a href="cal.html" class="dateOverlay">'+g+"</a>").trigger("create");
$(".loader").hide()})}function setCity(){var a;1==city&&(a="Dresden");2==city&&(a="Leipzig");$(".cityOverlay .ui-btn-text").text(a)}function get_calendar_height(){return $(window).height()-115}function setMarkers(a,b,c,f){b=new google.maps.LatLng(b,c);var g=new google.maps.Marker({position:b,map:a});google.maps.event.addListener(g,"click",function(){infowindow.setContent(f);infowindow.open(a,g)})}
function loadLiveMap(){var a=new Date,a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),b=new google.maps.LatLngBounds,a=Date.parse(a),a=a/1E3,c={zoom:4,mapTypeId:google.maps.MapTypeId.ROADMAP},f=new google.maps.Map(document.getElementById("live_map_canvas"),c);infowindow=new google.maps.InfoWindow({content:"loading..."});$(".loader").show();$.get("http://www.banq.de/api/api3.php?action=getEvents&cityId="+city+"&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json&timestamp="+a,function(a){$.each(a.event,
function(a,c){var g="",s="",h="",l="",m="";null!=c.eventLocation.longitude&&(c.eventDate.lineup&&(lineup=c.eventDate.lineup.replace(/\n/g,"<br />")),c.eventDate.name&&(s=c.eventDate.name.replace(/\n/g,"<br />")),c.eventLocation.name&&(h=c.eventLocation.name.replace(/\n/g,"<br />")),c.eventDate.startTime&&(l=c.eventDate.startTime.replace(/\n/g,"<br />")),m=c.eventDate.price?c.eventDate.price.replace(/\n/g,"<br />"):"Keine Angabe",g=g+("<p style='font-size:14px; margin:0;'><strong>Was:</strong> "+s+
"</p>")+("<p style='font-size:14px; margin:0;'><strong>Wo:</strong> "+h+"</p>"),g+="<p style='font-size:14px; margin:0;'><strong>Wann:</strong> "+l.substring(0,5)+" Uhr</p>",g+="<p style='font-size:14px; margin:0;'><strong>Preis:</strong> "+m+"</p>",b.extend(new google.maps.LatLng(c.eventLocation.latitude,c.eventLocation.longitude)),setMarkers(f,c.eventLocation.latitude,c.eventLocation.longitude,g))});f.fitBounds(b);$(".loader").hide()});navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){a=
new google.maps.LatLng(a.coords.latitude,a.coords.longitude);new google.maps.Marker({position:a,map:f,icon:"img/clientpos.png"});b.extend(a);f.fitBounds(b)})}
function loadMap(a,b,c){a=new google.maps.LatLng(a,b);var f=new google.maps.LatLngBounds;b={zoom:4,mapTypeId:google.maps.MapTypeId.ROADMAP};var g=new google.maps.Map(document.getElementById("map_canvas"),b);f.extend(a);marker=new google.maps.Marker({position:a,map:g});a=new google.maps.InfoWindow;a.setContent(c);a.open(g,marker);g.fitBounds(f);navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){a=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);new google.maps.Marker({position:a,
map:g,icon:"img/clientpos.png"});f.extend(a);g.fitBounds(f)})}function deviceReady(){navigator.splashscreen.hide();document.addEventListener("backbutton",hitBackBtn,!1);!1==checkConnection()&&$.mobile.changePage($("#four"))}function hitBackBtn(){"start"==$.mobile.activePage.attr("id")?navigator.app.exitApp():navigator.app.backHistory()}function blockUI(){$(".loader").show()}function unblockUI(){$(".loader").hide()}
function checkConnection(){browser=!0;if(!1==browser&&Connection.NONE==navigator.network.connection.type||!1==browser&&null==navigator.network.connection.type)return!1}
function checkForUpdates(){$.get("http://www.banq.de/api/api3.php?action=getMaxActiveNewsId&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(a){newsID=a.maxActiveNewsId});$.get("http://www.banq.de/api/api3.php?action=getMaxActiveColumnId&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(a){kolID=a.maxActiveColumnId});$.get("http://www.banq.de/api/api3.php?action=getMaxActiveRaffleId&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(a){ticketID=
a.maxActiveRaffleId});$.get("http://www.banq.de/api/api3.php?action=getMaxActiveSpecialId&apiKey=acd8b192c5aad5f134d1e4d5b70a299a&outputFormat=json",function(a){specialID=a.maxActiveSpecialId});dbResult=db.transaction(checkUpdatesDB,errorCB)}function insertDB(a){$.each(dbReadData,function(b,c){a.executeSql('INSERT INTO lastRead(value, read_id, read) VALUES ("'+c.value+'", "'+c.id+'", "'+c.read+'")')});checkReadStatus(a)}
function populateDB(a){a.executeSql("CREATE TABLE IF NOT EXISTS lastRead (id INTEGER PRIMARY KEY AUTOINCREMENT, value BLOB, read_id INTEGER, read INTEGER)")}function successCB(){alert("Erfolgreich gespeichert!")}function errorCB(){}function checkUpdatesDB(a){a.executeSql("SELECT * FROM lastRead",[],checkSuccess,errorCB)}
function checkSuccess(a,b){var c;0==b.rows.length?(dbReadData={news:{value:"news",id:12,read:0},kolumne:{value:"kolumne",id:13,read:0},ticket:{value:"ticket",id:14,read:0},special:{value:"special",id:15,read:0}},db.transaction(insertDB,errorCB)):(dbReadData={},$.each(b.rows,function(a){c=b.rows.item(a);"news"==c.value&&c.read_id!=newsID&&(dbReadData.news={value:c.value,id:newsID,read:0});"kolumne"==c.value&&c.read_id!=kolID&&(dbReadData.kolumne={value:c.value,id:kolID,read:0});"ticket"==c.value&&
c.read_id!=ticketID&&(dbReadData.ticket={value:c.value,id:ticketID,read:0});"special"==c.value&&c.read_id!=specialID&&(dbReadData.special={value:c.value,id:specialID,read:0})}),db.transaction(updateID,errorCB))}function checkReadStatus(a){a.executeSql("SELECT * FROM lastRead",[],checkReadSuccess)}function checkReadSuccess(a,b){var c;$.each(b.rows,function(a){c=b.rows.item(a);0==c.read?$(".new_"+c.value).show():$(".new_"+c.value).hide()})}
function updateID(a){$.each(dbReadData,function(b,c){a.executeSql("UPDATE lastRead SET read_id = "+c.id+", read = "+c.read+' WHERE value = "'+c.value+'"')});checkReadStatus(a)}function setRead(a){a.executeSql('UPDATE lastRead SET read = 1 WHERE value = "'+pageName+'"');checkReadStatus(a)}function dropOldDB(a){a.executeSql("DROP TABLE IF EXISTS Merkzettel")};